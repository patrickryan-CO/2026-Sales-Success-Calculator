<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trimble 2026 Success Plan</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#0063a3',       
                        'primary-hover': '#004a7c', 
                        'accent': '#fbad26',        
                        'primary-text': '#252a2e',  
                        'icon-people': '#6f42c1',    
                        'icon-pipeline': '#007bff',
                        'icon-prod': '#fd7e14',      
                    },
                    fontFamily: {
                        'sans': ['Open Sans', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Open Sans', sans-serif; color: #252a2e; background-color: #F1F1F6; min-height: 100vh; position: relative; overflow-x: hidden; }
        .wave-container { position: absolute; top: 0; left: 0; width: 100%; height: 600px; z-index: 0; overflow: hidden; }
        .wave-svg { width: 100%; height: 100%; display: block; }
        .main-card { position: relative; z-index: 10; background-color: white; border-radius: 0.75rem; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); width: 95%; max-width: 64rem; margin: 2rem auto 5rem auto; overflow: hidden; }
        .card-content { padding: 1.5rem; position: relative; }
        @media (min-width: 768px) { .card-content { padding: 2.5rem; } .main-card { margin-top: 5rem; } }

        .tooltip-trigger {
            display: inline-flex; align-items: center; justify-content: center;
            width: 1.1rem; height: 1.1rem; margin-left: 0.5rem;
            background-color: #9CA3AF; color: white; border-radius: 50%;
            cursor: help; font-size: 0.7rem; position: relative; font-weight: bold;
        }
        .tooltip-trigger::after {
            content: attr(data-tooltip); position: absolute; bottom: 140%; left: 50%;
            transform: translateX(-50%); background-color: #252a2e; color: white;
            padding: 0.5rem 0.75rem; border-radius: 0.25rem; width: 220px;
            opacity: 0; visibility: hidden; transition: all 0.2s; z-index: 50; font-size: 0.75rem; font-weight: 500;
            pointer-events: none; line-height: 1.4; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tooltip-trigger:hover::after { opacity: 1; visibility: visible; }

        .coach-note { font-size: 0.95rem; color: #252a2e; background-color: #fffbeb; border-left: 4px solid #fbad26; padding: 1.5rem; margin-bottom: 2rem; border-radius: 0 0.5rem 0.5rem 0; line-height: 1.6; }
        .coach-note strong { color: #0063a3; font-weight: 800; display: inline; }
        
        .step-heading { font-size: 1.5rem; font-weight: 800; color: #0063a3; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid #e5e7eb; }
        .input-label { display: flex; align-items: center; font-size: 0.9rem; font-weight: 700; color: #252a2e; margin-bottom: 0.375rem; }
        .input-field { display: block; width: 100%; border-radius: 0.375rem; border: 1px solid #D1D5DB; padding: 0.75rem; font-size: 1rem; color: #252a2e; transition: all 0.2s; }
        
        .progress-bar-grid { display: grid; grid-template-columns: repeat(5, 1fr); border-bottom: 2px solid #E5E7EB; margin-bottom: 2rem; }
        .progress-step { padding: 0.75rem 0.25rem; text-align: center; font-size: 0.7rem; font-weight: 600; color: #9CA3AF; border-bottom: 4px solid transparent; }
        .progress-step-active { color: #0063a3; border-bottom-color: #0063a3; }
        
        .calc-box { background-color: #F9FAFB; border: 1px solid #E5E7EB; border-radius: 0.5rem; padding: 1rem; text-align: center; }
        .calc-output { display: block; font-size: 1.5rem; font-weight: 800; color: #0063a3; margin-top: 0.25rem; }
        
        .btn { display: inline-block; font-weight: 700; text-align: center; padding: 0.75rem 1.5rem; border-radius: 0.375rem; transition: all 0.15s ease-in-out; cursor: pointer; border: none; width: 100%; }
        @media (min-width: 640px) { .btn { width: auto; } }
        .btn-primary { background-color: #0063a3; color: white; }
        .btn-accent { background-color: #fbad26; color: #252a2e; }
        .btn-default { background-color: #E5E7EB; color: #252a2e; }
        
        input[type=range] { width: 100%; height: 8px; border-radius: 5px; background: #e5e7eb; outline: none; -webkit-appearance: none; margin: 10px 0; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 20px; height: 20px; border-radius: 50%; background: #0063a3; cursor: pointer; border: 2px solid white; box-shadow: 0 1px 3px rgba(0,0,0,0.3); }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="wave-container">
        <svg class="wave-svg" viewBox="0 0 1440 600" preserveAspectRatio="none">
            <path fill="#0063a3" d="M0,0 L1440,0 L1440,350 Q720,600 0,350 Z"></path>
        </svg>
    </div>

    <div class="main-card">
        <div class="card-content">
            <div class="absolute top-2 right-4 text-xs text-gray-300 font-mono select-none">v12.10.45</div>

            <div id="welcome-screen">
                <div class="text-center space-y-6">
                    <div class="space-y-2">
                        <h1 class="text-3xl md:text-4xl font-extrabold text-primary-text">Trimble 2026 Success Plan</h1>
                        <p class="text-lg md:text-xl font-medium text-gray-500">Build Your Path.</p>
                    </div>

                    <div class="bg-white border border-gray-200 rounded-lg shadow-sm text-left overflow-hidden max-w-4xl mx-auto">
                        <div class="bg-blue-50 px-6 py-4 border-b border-blue-100">
                            <h3 class="text-primary font-bold text-lg">Your Blueprint for Success</h3>
                        </div>
                        <div class="p-6 space-y-4">
                            <p class="text-gray-700 leading-relaxed">
                                Welcome to your 2026 planning session. This tool is your guide to building a personal roadmap for the year ahead. Whether you carry a quota or support the wider mission, this plan belongs to you. It creates the clarity you need to define your goals and build a predictable path to success.
                            </p>
                            <div class="flex items-start">
                                <div class="shrink-0 h-8 w-8 rounded-full bg-primary flex items-center justify-center text-white font-bold text-sm">1</div>
                                <p class="ml-4 text-gray-700"><strong>Establish Baseline.</strong> Use your 2025 actual results to establish historical efficiency.</p>
                            </div>
                            <div class="flex items-start">
                                <div class="shrink-0 h-8 w-8 rounded-full bg-primary flex items-center justify-center text-white font-bold text-sm">2</div>
                                <p class="ml-4 text-gray-700"><strong>Identify the Gap.</strong> Visualize the requirements needed to achieve your 2026 targets based on current performance.</p>
                            </div>
                            <div class="flex items-start">
                                <div class="shrink-0 h-8 w-8 rounded-full bg-primary flex items-center justify-center text-white font-bold text-sm">3</div>
                                <p class="ml-4 text-gray-700"><strong>Define Strategy.</strong> Commit to the specific professional actions that will secure your results.</p>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-left max-w-5xl mx-auto px-4">
                        <div class="p-6 border border-gray-200 rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow">
                            <div class="text-icon-people mb-4">
                                <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                            </div>
                            <h3 class="text-xl font-bold text-primary-text mb-2">People</h3>
                            <ul class="text-sm text-gray-600 list-disc list-inside space-y-1"><li>Identify skill gaps</li><li>Commit to coaching</li></ul>
                        </div>
                        <div class="p-6 border border-gray-200 rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow">
                            <div class="text-icon-pipeline mb-4">
                                <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                            </div>
                            <h3 class="text-xl font-bold text-primary-text mb-2">Pipeline</h3>
                            <ul class="text-sm text-gray-600 list-disc list-inside space-y-1"><li>Calculate coverage</li><li>Sourcing strategy</li></ul>
                        </div>
                        <div class="p-6 border border-gray-200 rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow">
                            <div class="text-icon-prod mb-4">
                                <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                            </div>
                            <h3 class="text-xl font-bold text-primary-text mb-2">Productivity</h3>
                            <ul class="text-sm text-gray-600 list-disc list-inside space-y-1"><li>Audit your calendar</li><li>Master selling tools</li></ul>
                        </div>
                    </div>

                    <button type="button" id="startBtn" class="btn btn-primary text-lg px-10 py-4 shadow-lg">Start My Plan</button>
                </div>
            </div>

            <div id="wizard-container" class="hidden">
                <nav class="progress-bar-grid">
                    <div id="progress-1" class="progress-step progress-step-active">Baseline</div>
                    <div id="progress-2" class="progress-step">The Gap</div>
                    <div id="progress-3" class="progress-step">Solution</div>
                    <div id="progress-4" class="progress-step">Actions</div>
                    <div id="progress-5" class="progress-step">Review</div>
                </nav>

                <form id="skoForm" onsubmit="return false;">
                    
                    <div id="step-1-content" class="step-panel">
                        <h2 class="step-heading">Phase 1 : Baseline</h2>
                        <div class="coach-note">
                            <strong>PLEASE READ:</strong> Do you have a Scorecard with your 2025 performance data?
                            <ul class="list-disc list-inside mt-2">
                                <li><strong>YES:</strong> Enter your actual values below to calculate your efficiency baseline.</li>
                                <li><strong>NO:</strong> If you are new to the role or do not have historical data, enter <strong>"0"</strong> in the numeric fields below to move directly to the Action Plan.</li>
                            </ul>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div><label class="input-label">Professional Name</label><input type="text" id="personName" class="input-field"></div>
                            <div><label class="input-label">Manager Name</label><input type="text" id="managerName" class="input-field"></div>
                            <div class="md:col-span-2">
                                <label class="input-label">Operational Region</label>
                                <select id="region" class="input-field">
                                    <option value="" disabled selected>Select region</option>
                                    <option value="Americas - Customer">Americas - Customer</option>
                                    <option value="Americas - New Logo">Americas - New Logo</option>
                                    <option value="APAC">APAC</option>
                                    <option value="EMEA">EMEA</option>
                                    <option value="O&PS">O&PS</option>
                                </select>
                            </div>
                            <div><label class="input-label">2025 Quota Target ($)</label><input type="text" id="quota2025" class="input-field" placeholder="0"></div>
                            <div><label class="input-label">2025 Comped Bookings ($) <span class="tooltip-trigger" data-tooltip="Total sales recognized for commission in 2025.">i</span></label><input type="text" id="bookings2025" class="input-field" placeholder="0"></div>
                            <div><label class="input-label">2025 ACV Based Win Rate (%) <span class="tooltip-trigger" data-tooltip="The percentage of qualified opportunities won based on Annual Contract Value.">i</span></label><input type="number" id="winRate2025" class="input-field" placeholder="0"></div>
                            <div><label class="input-label">2025 Overall Average Deal Size ($) <span class="tooltip-trigger" data-tooltip="Total revenue divided by the number of closed-won opportunities.">i</span></label><input type="text" id="avgDealSize2025" class="input-field" placeholder="0"></div>
                            <div class="calc-box md:col-span-2"><span>2025 Performance Attainment</span><span id="attainment2025" class="calc-output">0%</span></div>
                        </div>
                    </div>

                    <div id="step-2-content" class="step-panel hidden">
                        <h2 class="step-heading">Phase 2 : The Gap</h2>
                        <div class="coach-note">
                            <strong>What does this mean?</strong> This section calculates the pipeline required if your 2026 efficiency remains identical to 2025. It illustrates the effort needed to reach your 2026 target based on historical performance and highlights the growth gap you must address.
                            <br><br><strong>NOTE:</strong> If you entered "0" in Phase 1, these values will remain at 0. Select Next to proceed.
                        </div>
                        <div class="max-w-md mx-auto space-y-6 text-center">
                            <div><label class="input-label justify-center text-lg">2026 Quota Target (A)</label><input type="text" id="quota2026" class="input-field text-center font-bold text-xl" placeholder="e.g. 1,200,000"></div>
                            <div class="calc-box"><span>Required Pipeline (B)</span><span id="pipelineToClose2026" class="calc-output text-primary">$0</span><span class="text-[10px] text-gray-500 uppercase">(Quota / 2025 Win Rate)</span></div>
                            <div class="calc-box"><span>Required Volume (C)</span><span id="dealsToClose2026" class="calc-output text-primary">0</span><span class="text-[10px] text-gray-500 uppercase">(Quota / 2025 Deal Size)</span></div>
                        </div>
                        <div class="mt-8 p-4 bg-gray-50 rounded-lg">
                            <label class="input-label">Current Sentiment Check</label>
                            <p class="text-xs text-gray-600 mb-3">Please provide an honest assessment of this target. This helps your leadership understand your perspective on the 2026 objective.</p>
                            <div class="flex flex-wrap gap-6">
                                <label class="flex items-center space-x-2"><input type="radio" name="reflection" value="Achievable"><span>Achievable</span></label>
                                <label class="flex items-center space-x-2"><input type="radio" name="reflection" value="Challenging"><span>Challenging</span></label>
                                <label class="flex items-center space-x-2"><input type="radio" name="reflection" value="Impossible"><span>Impossible</span></label>
                            </div>
                        </div>
                    </div>

                    <div id="step-3-content" class="step-panel hidden">
                        <h2 class="step-heading">Phase 3 : The Solution</h2>
                        <div class="coach-note">
                            <strong>Strategic Efficiency:</strong> Use the sliders to model professional growth. Small improvements in your Win Rate or Deal Size compound to significantly reduce the pressure to generate new pipeline volume.
                            <br><br><strong>NOTE:</strong> If you entered "0" in Phase 1, you may proceed directly to the next phase.
                        </div>
                        <div class="space-y-8">
                            <div class="bg-white border rounded-lg p-6 shadow-sm">
                                <label class="input-label">Lever 1: Quarterly Meetings Growth: <span id="meetingImprovementLabel" class="text-primary ml-1">0</span></label>
                                <input type="range" id="meetingImprovement" min="0" max="20" value="0" step="1">
                                <div class="mt-4"><label class="input-label">Target Win Rate % (Activity Driven)</label><input type="number" id="meetingsImpliedWinRate" class="input-field" placeholder="e.g. 28"></div>
                                <div class="mt-2 text-primary font-bold text-center">Pipeline Required: <span id="meetingsPipelineNeeded">$0</span></div>
                            </div>
                            <div class="bg-white border rounded-lg p-6 shadow-sm">
                                <label class="input-label">Lever 2: Average Deal Value Growth: <span id="dealSizeImprovementLabel" class="text-primary ml-1">0%</span></label>
                                <input type="range" id="dealSizeImprovement" min="0" max="50" value="0" step="1">
                                <div class="mt-2 text-primary font-bold text-center">Volume Required: <span id="newDealsNeeded">0</span></div>
                            </div>
                            <div class="bg-white border rounded-lg p-6 shadow-sm">
                                <label class="input-label">Lever 3: Targeted Win Rate Growth: <span id="winRateImprovementLabel" class="text-primary ml-1">0%</span></label>
                                <input type="range" id="winRateImprovement" min="0" max="15" value="0" step="0.5">
                                <div class="mt-2 text-primary font-bold text-center">Pipeline Required: <span id="newPipelineNeeded">$0</span></div>
                            </div>
                        </div>
                    </div>

                    <div id="step-4-content" class="step-panel hidden">
                        <h2 class="step-heading">Phase 4 : Action Plan</h2>
                        
                        <div class="coach-note">
                            <strong>Building High-Quality Commitments:</strong> To ensure your success, define your goals using the <strong>SMART</strong> framework. If you are unfamiliar with this method, follow these principles:
                            <ul class="list-disc list-inside mt-3 space-y-2 text-sm text-gray-700">
                                <li><strong>Specific:</strong> Clearly state exactly what action you will take.</li>
                                <li><strong>Measurable:</strong> Include a number or specific milestone to track progress.</li>
                                <li><strong>Achievable:</strong> Ensure the goal is realistic given your time and resources.</li>
                                <li><strong>Relevant:</strong> Your action should directly improve your primary focus area.</li>
                                <li><strong>Time-bound:</strong> Define a clear deadline for completion.</li>
                            </ul>
                        </div>

                        <div class="space-y-8">
                            <div>
                                <label class="input-label text-lg">Strategic Focus Area</label>
                                <p class="text-sm text-gray-600 mb-3">Select the primary lever that will define your strategy this year. Focusing your energy on one core metric often leads to the most predictable results.</p>
                                <div class="flex flex-col gap-3">
                                    <label class="flex items-center space-x-3 p-3 border rounded bg-white hover:bg-gray-50 cursor-pointer">
                                        <input type="checkbox" name="entry.1090213679" value="Win Rate" class="h-5 w-5 text-primary">
                                        <span class="text-primary-text font-medium">Win Rate</span>
                                    </label>
                                    <label class="flex items-center space-x-3 p-3 border rounded bg-white hover:bg-gray-50 cursor-pointer">
                                        <input type="checkbox" name="entry.1090213679" value="Deal Size" class="h-5 w-5 text-primary">
                                        <span class="text-primary-text font-medium">Deal Size</span>
                                    </label>
                                    <label class="flex items-center space-x-3 p-3 border rounded bg-white hover:bg-gray-50 cursor-pointer">
                                        <input type="checkbox" name="entry.1090213679" value="Deal Count" class="h-5 w-5 text-primary">
                                        <span class="text-primary-text font-medium">Deal Count</span>
                                    </label>
                                </div>
                            </div>

                            <div>
                                <label class="input-label text-lg">Strategic Goal: People Upskilling</label>
                                <p class="text-sm text-gray-600 mb-3">Define how you will improve your professional expertise. Identify specific sales skills, product knowledge levels, or professional certifications you will achieve to close your gap.</p>
                                <textarea id="action-people" class="input-field" rows="3" placeholder="Enter your commitment here..."></textarea>
                            </div>

                            <div>
                                <label class="input-label text-lg">Strategic Goal: Pipeline Sourcing</label>
                                <p class="text-sm text-gray-600 mb-3">Pipeline generation is essential for long-term predictability. Define the regular sourcing routine or cross-functional strategy you will implement to maintain a healthy funnel.</p>
                                <textarea id="action-pipeline" class="input-field" rows="3" placeholder="Enter your commitment here..."></textarea>
                            </div>

                            <div>
                                <label class="input-label text-lg">Strategic Goal: Productivity Tools</label>
                                <p class="text-sm text-gray-600 mb-3">Efficiency is maximized by protecting your selling time. Identify the professional tools or calendar routines you will adopt to automate administrative tasks and improve focus.</p>
                                <textarea id="action-productivity" class="input-field" rows="3" placeholder="Enter your commitment here..."></textarea>
                            </div>
                        </div>
                    </div>

                    <div id="step-5-content" class="step-panel hidden text-center">
                        <h2 class="step-heading text-left">Phase 5 : Review</h2>
                        <div id="commitmentSummaryOutput" class="bg-gray-50 p-6 rounded-lg font-mono text-xs border whitespace-pre-wrap text-left leading-relaxed mb-6"></div>
                        <div class="flex justify-center gap-4">
                            <button type="button" id="copyBtn" class="btn btn-default">Copy Plan Text</button>
                            <button type="button" id="submitBtn" class="btn btn-accent px-10 font-bold">Review Your Plan</button>
                        </div>
                    </div>

                    <div id="navigation-buttons" class="mt-8 pt-6 border-t flex justify-between items-center">
                        <button type="button" id="prevBtn" class="btn btn-default hidden">Previous</button>
                        <div class="flex-grow"></div>
                        <button type="button" id="nextBtn" class="btn btn-primary">Next</button>
                        <button type="button" id="printBtn" class="btn btn-default hidden ml-2">Save as PDF</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

<script>
    const CONFIG = {
        url: "https://docs.google.com/forms/d/e/1FAIpQLSdVizNI9jeThAxWU2FjxTcqaVfdsnXqaDbbDMzHg8Y4gGX1Hg/viewform",
        ids: { name: "entry.1533888544", mgr: "entry.2004467893", reg: "entry.909220528", quota: "entry.1187258724", people: "entry.1667466065", pipe: "entry.1553800751", prod: "entry.1571167359", primary: "entry.1090213679" }
    };
    const $ = (id) => document.getElementById(id);
    const getVal = (id) => parseFloat($(id).value.replace(/[$,]/g, '')) || 0;
    const fmt = (v) => '$' + v.toLocaleString(undefined, {maximumFractionDigits:0});

    function calculate() {
        const q25 = getVal('quota2025'), b25 = getVal('bookings2025'), wr25 = getVal('winRate2025'), ds25 = getVal('avgDealSize2025');
        const q26 = getVal('quota2026'), wrImp = getVal('winRateImprovement'), dsImp = getVal('dealSizeImprovement'), mtgWR = getVal('meetingsImpliedWinRate');

        $('attainment2025').innerText = q25 > 0 ? (b25/q25*100).toFixed(1) + '%' : '0%';
        const winDec = (wr25/100);
        const pGap = winDec > 0 ? q26 / winDec : 0;
        $('pipelineToClose2026').innerText = fmt(pGap);
        $('dealsToClose2026').innerText = ds25 > 0 ? Math.ceil(q26 / ds25) : 0;

        $('winRateImprovementLabel').innerText = wrImp + '%';
        $('newPipelineNeeded').innerText = fmt((wr25+wrImp)/100 > 0 ? q26 / ((wr25+wrImp)/100) : 0);
        
        $('dealSizeImprovementLabel').innerText = dsImp + '%';
        const nds = ds25 * (1 + (dsImp/100));
        $('newDealsNeeded').innerText = nds > 0 ? Math.ceil(q26 / nds) : 0;
        
        $('meetingImprovementLabel').innerText = $('meetingImprovement').value;
        $('meetingsPipelineNeeded').innerText = fmt((mtgWR/100) > 0 ? q26 / (mtgWR/100) : 0);
    }

    function renderSummary() {
        const checked = document.querySelectorAll(`input[name="${CONFIG.ids.primary}"]:checked`);
        const primaryFocus = Array.from(checked).map(cb => cb.value).join(', ') || '[Not Selected]';
        const text = `2026 SUCCESS PLAN COMMITMENT\n--------------------------------\nName: ${$('personName').value}\nManager: ${$('managerName').value}\n2026 Quota: ${fmt(getVal('quota2026'))}\n\nSTRATEGIC FOCUS: ${primaryFocus}\n\nPEOPLE: ${$('action-people').value}\nPIPELINE: ${$('action-pipeline').value}\nPRODUCTIVITY: ${$('action-productivity').value}`;
        $('commitmentSummaryOutput').innerText = text;
    }

    let step = 1;
    $('startBtn').onclick = () => { $('welcome-screen').classList.add('hidden'); $('wizard-container').classList.remove('hidden'); calculate(); };
    $('nextBtn').onclick = () => { if(step < 5) { step++; showStep(); } };
    $('prevBtn').onclick = () => { if(step > 1) { step--; showStep(); } };

    function showStep() {
        document.querySelectorAll('.step-panel').forEach((p, i) => p.classList.toggle('hidden', i + 1 !== step));
        document.querySelectorAll('.progress-step').forEach((s, i) => s.classList.toggle('progress-step-active', i < step));
        $('prevBtn').classList.toggle('hidden', step === 1);
        $('nextBtn').classList.toggle('hidden', step === 5);
        $('submitBtn').classList.toggle('hidden', step !== 5);
        $('printBtn').classList.toggle('hidden', step !== 5);
        if(step === 5) renderSummary();
        window.scrollTo(0,0);
    }
    
    $('submitBtn').onclick = () => {
        let url = `${CONFIG.url}?${CONFIG.ids.name}=${encodeURIComponent($('personName').value)}&${CONFIG.ids.mgr}=${encodeURIComponent($('managerName').value)}&${CONFIG.ids.reg}=${encodeURIComponent($('region').value)}&${CONFIG.ids.quota}=${getVal('quota2026')}&${CONFIG.ids.people}=${encodeURIComponent($('action-people').value)}&${CONFIG.ids.pipe}=${encodeURIComponent($('action-pipeline').value)}&${CONFIG.ids.prod}=${encodeURIComponent($('action-productivity').value)}`;
        const checkedBoxes = document.querySelectorAll(`input[name="${CONFIG.ids.primary}"]:checked`);
        checkedBoxes.forEach(cb => { url += `&${CONFIG.ids.primary}=${encodeURIComponent(cb.value)}`; });
        window.open(url, '_blank');
    };

    $('copyBtn').onclick = () => {
        navigator.clipboard.writeText($('commitmentSummaryOutput').innerText);
        $('copyBtn').innerText = "Copied!";
        setTimeout(() => $('copyBtn').innerText = "Copy Plan Text", 2000);
    };

    document.querySelectorAll('input, textarea').forEach(el => el.oninput = calculate);
    $('printBtn').onclick = () => window.print();
</script>
</body>
</html>
