<script>
    // --- Helper Functions ---
    const $ = (selector) => document.getElementById(selector);
    
    const formatLargeNumber = (val) => {
        if (isNaN(val) || !isFinite(val)) return '0';
        return val.toLocaleString('en-US', { maximumFractionDigits: 0 });
    };
    const formatPercent = (val) => {
        if (isNaN(val) || !isFinite(val)) return '0%';
        return val.toFixed(1) + '%';
    };
    const formatNumber = (val) => {
        if (isNaN(val) || !isFinite(val)) return '0';
        return val.toLocaleString('en-US', { maximumFractionDigits: 1 });
    };
    const formatCoverage = (val) => {
        if (isNaN(val) || !isFinite(val)) return '0.0x';
        return val.toFixed(1) + 'x';
    };

    // --- Main Calculation Function ---
    function calculatePlan() {
        // This function is safe and should not error, as all IDs are correct
        const quota2025 = parseFloat($('quota2025').value.replace(/,/g, '')) || 0;
        const bookings2025 = parseFloat($('bookings2025').value.replace(/,/g, '')) || 0;
        const winRate2025 = parseFloat($('winRate2025').value) || 0;
        const avgDealSize2025 = parseFloat($('avgDealSize2025').value.replace(/,/g, '')) || 0;
        const avgMeetings2025 = parseFloat($('avgMeetings2025').value) || 0;
        const quota2026 = parseFloat($('quota2026').value.replace(/,/g, '')) || 0;
        const winRateImprovement = parseFloat($('winRateImprovement').value) || 0;
        const dealSizeImprovement = parseFloat($('dealSizeImprovement').value) || 0;
        const meetingImprovement = parseFloat($('meetingImprovement').value) || 0;
        const meetingsImpliedWinRate = parseFloat($('meetingsImpliedWinRate').value) || 0;

        // Step 1
        $('attainment2025').textContent = formatPercent(quota2025 > 0 ? (bookings2025 / quota2025) * 100 : 0);

        // Step 2
        const winRateDecimal = winRate2025 / 100;
        $('pipelineToClose2026').textContent = formatLargeNumber(winRateDecimal > 0 ? quota2026 / winRateDecimal : 0);
        $('dealsToClose2026').textContent = formatNumber(avgDealSize2025 > 0 ? (winRateDecimal > 0 ? quota2026 / winRateDecimal : 0) / avgDealSize2025 : 0);

        // Step 3 - A
        const newWinRate = winRate2025 + winRateImprovement;
        const newWinRateDecimal = newWinRate / 100;
        $('winRateImprovementLabel').textContent = `${winRateImprovement.toFixed(1)}%`;
        $('newWinRateLabel').textContent = formatPercent(newWinRate);
        $('newPipelineNeeded').textContent = formatLargeNumber(newWinRateDecimal > 0 ? quota2026 / newWinRateDecimal : 0);
        $('newPipelineCoverage').textContent = formatCoverage(quota2026 > 0 ? (newWinRateDecimal > 0 ? quota2026 / newWinRateDecimal : 0) / quota2026 : 0);

        // Step 3 - B
        const newAvgDealSize = avgDealSize2025 * (1 + (dealSizeImprovement / 100));
        $('dealSizeImprovementLabel').textContent = `${dealSizeImprovement.toFixed(0)}%`;
        $('newAvgDealSizeLabel').textContent = formatLargeNumber(newAvgDealSize);
        $('newDealsNeeded').textContent = formatNumber(newAvgDealSize > 0 ? quota2026 / newAvgDealSize : 0);
        $('dealsPipelineCoverage').textContent = formatCoverage(quota2026 > 0 ? (winRateDecimal > 0 ? quota2026 / winRateDecimal : 0) / quota2026 : 0);

        // Step 3 - C
        const newMeetingAvg = avgMeetings2025 + meetingImprovement;
        const meetingsImpliedWinRateDecimal = meetingsImpliedWinRate / 100;
        $('meetingImprovementLabel').textContent = meetingImprovement.toFixed(0);
        $('newMeetingAvgLabel').textContent = newMeetingAvg.toFixed(0);
        $('meetingsPipelineNeeded').textContent = formatLargeNumber(meetingsImpliedWinRateDecimal > 0 ? quota2026 / meetingsImpliedWinRateDecimal : 0);
        $('meetingsPipelineCoverage').textContent = formatCoverage(quota2026 > 0 ? (meetingsImpliedWinRateDecimal > 0 ? quota2026 / meetingsImpliedWinRateDecimal : 0) / quota2026 : 0);
    }

    // --- Wizard Logic ---
    let currentStep = 1;
    const totalSteps = 4;

    function showStep(step) {
        for (let i = 1; i <= totalSteps; i++) {
            if($(`step-${i}-content`)) {
                $(`step-${i}-content`).classList.add('hidden');
            }
            if($(`progress-${i}`)) {
                $(`progress-${i}`).classList.remove('progress-step-active');
            }
        }
        const stepContent = $(`step-${step}-content`);
        if(stepContent) {
            stepContent.classList.remove('hidden');
        }
        for (let i = 1; i <= step; i++) {
            if($(`progress-${i}`)) {
                $(`progress-${i}`).classList.add('progress-step-active');
            }
        }
        
        if($('prevButton')) $('prevButton').style.display = (step === 1) ? 'none' : 'inline-block';
        if($('nextButton')) $('nextButton').style.display = (step === totalSteps) ? 'none' : 'inline-block';
        if($('printButton')) $('printButton').style.display = (step === totalSteps) ? 'inline-block' : 'none';
        if($('resetButton')) $('resetButton').style.display = (step === totalSteps) ? 'inline-block' : 'none';
        
        const heading = stepContent ? stepContent.querySelector('.step-heading') : null;
        if (heading) {
            heading.focus();
        }
    }

    // --- Event Listeners ---
    document.addEventListener('DOMContentLoaded', () => {
        
        // **THIS IS THE FIX**
        // The array now correctly uses 'quota2026' instead of the typo 'quota2Next'
        const inputsToTrack = [
            'quota2025', 'bookings2025', 'winRate2025', 'avgDealSize2025', 
            'quota2026', 'avgMeetings2025'
        ];
        
        inputsToTrack.forEach(id => {
            const el = $(id);
            if (el) {
                el.addEventListener('input', calculatePlan);
            }
        });
        
        const slidersAndInputs = [
            'winRateImprovement', 'dealSizeImprovement', 'meetingImprovement', 'meetingsImpliedWinRate'
        ];
        
        slidersAndInputs.forEach(id => {
            const el = $(id);
            if (el) {
                el.addEventListener('input', calculatePlan);
            }
        });

        const nextBtn = $('nextButton');
        if(nextBtn) {
            nextBtn.addEventListener('click', () => {
                if (currentStep < totalSteps) {
                    currentStep++;
                    showStep(currentStep);
                }
            });
        }

        const prevBtn = $('prevButton');
        if(prevBtn) {
            prevBtn.addEventListener('click', () => {
                if (currentStep > 1) {
                    currentStep--;
                    showStep(currentStep);
                }
            });
        }
        
        const resetBtn = $('resetButton');
        if(resetBtn) {
            resetBtn.addEventListener('click', ()...

**The problem is that I am not seeing the tooltips on the labels...**
